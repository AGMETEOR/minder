---
version: v1
type: pipeline-policy
name: acme-github-policy
context:
  organization: ACME
  provider: github
repository:
  - context: github
    rules:
      secret_scanning_enabled: true
      branch_protection_main:
        required_pull_request_reviews:
          dismiss_stale_reviews: true
          require_code_owner_reviews: true
          required_approving_review_count: 1
        required_linear_history: true
        allow_force_pushes: false
        allow_deletions: false
        allow_fork_syncing: true
ci-environment:
  - rules:  # Not specifying a context takes the default context
      no_org_wide_github_action_permissions: true
artifact:
  - context: github
    rules:
      ctlog_entry:
        state: exists
        rekor: 'https://rekor.acme.dev/'
        fulcio: 'https://fulcio.acme.dev/'
  - context: quay
    rules:
      ctlog_entry:
        state: exists
        rekor: 'https://rekor.acme.dev/'
        fulcio: 'https://fulcio.acme.dev/'